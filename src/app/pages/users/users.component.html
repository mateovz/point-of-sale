<div id="users" class="container">
  <div class="p-2 text-end">
    <button type="button" class="btn btn-primary mt-3" 
      data-bs-toggle="modal" data-bs-target="#registerModal" 
      (click)="onRegisterModal()" *ngIf="check('user.register')"
    >
      AÃ±adir nuevo
    </button>
    <modal-register 
      [modalData]="modalData.asObservable()"
      (updateUsers)="getUsers()"
    ></modal-register>
  </div>
  <div class="card">
    <div class="card-header">
      <ul class="nav nav-tabs card-header-tabs">
        <li class="nav-item">
          <button class="nav-link" [ngClass]="{'active':view=='table'}" (click)="view='table'">
            <i class="bi bi-table"></i>
          </button>
        </li>
        <li class="nav-item">
          <button class="nav-link" [ngClass]="{'active':view=='cards'}" (click)="view='cards'">
            <i class="bi bi-card-heading"></i>
          </button>
        </li>
      </ul>
    </div>
    <div class="card-body">
      <div class="row" *ngIf="view=='cards'">
        <component-card
          *ngFor="let user of users"
          [imgTop]="user.avatar"
          [title]="user.name"
        >
        </component-card>  
      </div>
      <div *ngIf="view=='table'">
        <table class="table table-hover">
            <thead>
              <tr>
                <th scope="col" *ngFor="let column of columns">{{column}}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of users">
                <th scope="row">{{user.id}}</th>
                <td><img class="avatar" [src]="user.avatar" [alt]="'avatar '+user.name"></td>
                <td>{{user.name}}</td>
                <td>{{user.email}}</td>
                <td class="roles">
                  <button type="button" class="btn btn-secondary" 
                    *ngFor="let role of user.roles"
                  >
                    {{role.name}}
                  </button>
                </td>
                <td>
                  <button type="button" class="btn btn-warning me-2" title="Editar"
                    data-bs-toggle="modal" data-bs-target="#registerModal" 
                    (click)="onUpdateModal(user)" *ngIf="check('user.update')"
                  >
                    <i class="bi bi-pencil-fill text-light"></i>
                  </button>
                  <button type="button" class="btn btn-danger me-2" title="Eliminar"
                    (click)="onDelete(user)" *ngIf="check('user.delete')"
                  >
                    <i class="bi bi-trash3-fill"></i>
                  </button>
                </td>
              </tr>
            </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

